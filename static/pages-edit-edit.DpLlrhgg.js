import{r as e,k as s,a as t,w as a,D as l,z as c,i as n,E as o,s as i,o as u,b as d,f,d as r,e as _,S as p,m,F as h,p as v,n as g,G as k,t as x,B as y,H as C,g as w,J as b,K as I,h as $}from"./index-DjgUAJ8w.js";import{C as L}from"./index.dnR_Pn36.js";import{g as S,a as j,b as P}from"./api.BPvK5VrC.js";import{_ as E}from"./_plugin-vue_export-helper.BCo6x5W8.js";const U=E({__name:"edit",setup(E){const U=e(!1),F=e("é«˜æ¸…"),M=e(!1),z=e([]),B=e(null),D=e(""),G=e(null),H=()=>{i({title:"æ‰“å¼€æ—¶é—´è½´ç¼–è¾‘å™¨",icon:"none"})},J=()=>{C({itemList:["æ¸…æ–°","å¤å¤","é»‘ç™½","æš–è‰²","å†·è‰²","ç”µå½±","æ—¥ç³»","æ¸¯é£Ž","æ¬§ç¾Ž","æ›´å¤š..."],success:e=>{i({title:`åº”ç”¨æ»¤é•œ: ${e.tapIndex}`,icon:"success"})}})},K=()=>{i({title:"æ‰“å¼€æ–‡å­—ç¼–è¾‘å™¨",icon:"none"})},T=()=>{C({itemList:["æŽ¨èéŸ³ä¹","æœ¬åœ°å¯¼å…¥","æˆ‘çš„æ”¶è—"],success:e=>{i({title:"é€‰æ‹©: "+(0===e.tapIndex?"æŽ¨èéŸ³ä¹":1===e.tapIndex?"æœ¬åœ°å¯¼å…¥":"æˆ‘çš„æ”¶è—"),icon:"none"})}})},q=()=>{C({itemList:["æ…¢åŠ¨ä½œ","å¿«åŠ¨ä½œ","å€’æ”¾","å®šæ ¼","è½¬åœºç‰¹æ•ˆ"],success:e=>{i({title:`æ·»åŠ ç‰¹æ•ˆ: ${e.tapIndex}`,icon:"success"})}})},A=e=>{if(!e)return"00:00";const s=Math.floor(e/60),t=Math.floor(e%60);return`${s.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},N=async e=>{try{B.value=e.id,G.value=e;const s=P(e.id);D.value=s,o({selector:".preview-section",duration:300})}catch(s){console.error("é€‰æ‹©è§†é¢‘æ®µå¤±è´¥:",s),i({title:"åŠ è½½è§†é¢‘å¤±è´¥",icon:"none"})}},O=()=>{U.value=!0},Q=()=>{U.value=!1},R=()=>{U.value=!1},V=()=>{C({itemList:["æ ‡æ¸…","é«˜æ¸…","è¶…æ¸…"],success:e=>{F.value=["æ ‡æ¸…","é«˜æ¸…","è¶…æ¸…"][e.tapIndex],i({title:`å·²é€‰æ‹©: ${F.value}`,icon:"success"})}})},W=()=>{M.value=!1},X=()=>{W(),i({title:"åˆ†äº«åˆ°å¾®ä¿¡",icon:"success"})},Y=()=>{W(),i({title:"åˆ†äº«åˆ°å¾®åš",icon:"success"})},Z=()=>{W(),i({title:"åˆ†äº«åˆ°æŠ–éŸ³",icon:"success"})},ee=()=>{W(),C({itemList:["ä¿å­˜åˆ°ç›¸å†Œ","å¤åˆ¶é“¾æŽ¥","å…¶ä»–å¹³å°"],success:e=>{i({title:`é€‰æ‹©: ${e.tapIndex}`,icon:"none"})}})},se=async()=>{if(D.value)try{w({title:"å¯¼å‡ºä¸­..."});const e=await b({url:D.value});if(200!==e.statusCode)throw new Error("ä¸‹è½½å¤±è´¥");await I({filePath:e.tempFilePath}),$(),i({title:"å¯¼å‡ºæˆåŠŸ",icon:"success",duration:1500}),setTimeout(()=>{M.value=!0},500)}catch(e){console.error("å¯¼å‡ºå¤±è´¥:",e),$(),i({title:e.message||"å¯¼å‡ºå¤±è´¥",icon:"none"})}else i({title:"è¯·å…ˆé€‰æ‹©è§†é¢‘æ®µ",icon:"none"})};s(()=>{(async()=>{var e,s;try{let a=[];const n=l(),o=n[n.length-1],i=(null==(e=o.options)?void 0:e.cameraCode)||c("cameraCode");if(i)try{a=await S(i)}catch(t){console.log("é€šè¿‡æ‘„åƒå¤´ç èŽ·å–å¤±è´¥:",t)}if(0===a.length){const e=(null==(s=o.options)?void 0:s.recordingId)||c("recordingId");if(e)try{a=await j(e)}catch(t){console.log("é€šè¿‡recordingIdèŽ·å–å¤±è´¥:",t)}}z.value=a.map(e=>({...e,videoUrl:e.id?P(e.id):null})),z.value.length>0&&N(z.value[0])}catch(t){console.error("åŠ è½½è§†é¢‘æ®µåˆ—è¡¨å¤±è´¥:",t),z.value=[]}})()});const te=()=>{i({title:"ä½¿ç”¨å¸®åŠ©",icon:"none"})};return(e,s)=>{const l=r,c=n,o=k,i=p;return u(),t(c,{class:"edit-container"},{default:a(()=>[d(c,{class:"top-header"},{default:a(()=>[d(l,{class:"page-title"},{default:a(()=>[_("è§†é¢‘å‰ªè¾‘")]),_:1}),d(c,{class:"header-actions"},{default:a(()=>[d(c,{class:"action-btn",onClick:te},{default:a(()=>[d(l,{class:"action-icon"},{default:a(()=>[_("â“")]),_:1})]),_:1})]),_:1})]),_:1}),d(i,{class:"content-scroll","scroll-y":""},{default:a(()=>[d(c,{class:"section"},{default:a(()=>[d(c,{class:"section-header"},{default:a(()=>[d(l,{class:"section-title"},{default:a(()=>[_("è§†é¢‘æ®µåˆ—è¡¨")]),_:1}),d(l,{class:"section-subtitle"},{default:a(()=>[_("ç‚¹å‡»é€‰æ‹©æ’­æ”¾")]),_:1})]),_:1}),d(c,{class:"video-segments-grid"},{default:a(()=>[(u(!0),m(h,null,v(z.value,(e,s)=>(u(),t(c,{key:e.id||s,class:g(["segment-item",{selected:B.value===e.id}]),onClick:s=>N(e)},{default:a(()=>[d(c,{class:"segment-thumbnail"},{default:a(()=>[e.videoUrl?(u(),t(o,{key:0,src:e.videoUrl,class:"segment-video",controls:!1,"show-center-play-btn":!0,"enable-play-gesture":!1,poster:e.thumbnail},null,8,["src","poster"])):(u(),t(c,{key:1,class:"segment-placeholder"},{default:a(()=>[d(l,{class:"segment-icon"},{default:a(()=>[_("ðŸŽ¬")]),_:1})]),_:1})),d(c,{class:"segment-overlay"},{default:a(()=>[d(l,{class:"segment-play-icon"},{default:a(()=>[_("â–¶ï¸")]),_:1})]),_:1})]),_:2},1024),d(c,{class:"segment-info"},{default:a(()=>[d(l,{class:"segment-title"},{default:a(()=>[_("è§†é¢‘æ®µ "+x(void 0!==e.segment_index?e.segment_index+1:s+1),1)]),_:2},1024),e.duration?(u(),t(l,{key:0,class:"segment-duration"},{default:a(()=>[_(x(A(e.duration)),1)]),_:2},1024)):f("",!0)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),D.value?(u(),t(c,{key:0,class:"section"},{default:a(()=>[d(c,{class:"section-header"},{default:a(()=>[d(l,{class:"section-title"},{default:a(()=>[_("å½“å‰æ’­æ”¾")]),_:1})]),_:1}),d(c,{class:"preview-section"},{default:a(()=>[d(c,{class:"preview-window"},{default:a(()=>[d(o,{src:D.value,class:"preview-video",controls:!0,"show-center-play-btn":!0,"enable-play-gesture":!0,onPlay:O,onPause:Q,onEnded:R},null,8,["src"])]),_:1})]),_:1}),d(c,{class:"export-section"},{default:a(()=>[d(c,{class:"export-options"},{default:a(()=>[d(c,{class:"option-item",onClick:V},{default:a(()=>[d(c,{class:"option-left"},{default:a(()=>[d(l,{class:"option-icon"},{default:a(()=>[_("ðŸ“Š")]),_:1}),d(l,{class:"option-label"},{default:a(()=>[_("å¯¼å‡ºè´¨é‡")]),_:1})]),_:1}),d(c,{class:"option-right"},{default:a(()=>[d(l,{class:"option-value"},{default:a(()=>[_(x(F.value),1)]),_:1}),d(l,{class:"option-arrow"},{default:a(()=>[_("â€º")]),_:1})]),_:1})]),_:1})]),_:1}),d(c,{class:"export-btn",onClick:se},{default:a(()=>[d(l,{class:"export-icon"},{default:a(()=>[_("ðŸ“¤")]),_:1}),d(l,{class:"export-text"},{default:a(()=>[_("å¯¼å‡ºè§†é¢‘")]),_:1})]),_:1})]),_:1})]),_:1})):f("",!0),d(c,{class:"section"},{default:a(()=>[d(c,{class:"section-header"},{default:a(()=>[d(l,{class:"section-title"},{default:a(()=>[_("ç¼–è¾‘åŠŸèƒ½")]),_:1}),d(l,{class:"section-subtitle"},{default:a(()=>[_("ä¸°å¯Œçš„ç¼–è¾‘å·¥å…·")]),_:1})]),_:1}),d(c,{class:"function-grid"},{default:a(()=>[d(c,{class:"function-item",onClick:H},{default:a(()=>[d(c,{class:"function-icon timeline-icon"},{default:a(()=>[_("â±ï¸")]),_:1}),d(l,{class:"function-name"},{default:a(()=>[_("æ—¶é—´è½´å‰ªè¾‘")]),_:1}),d(l,{class:"function-desc"},{default:a(()=>[_("æ‹–æ‹½/åˆ†å‰²/åˆ é™¤")]),_:1})]),_:1}),d(c,{class:"function-item",onClick:J},{default:a(()=>[d(c,{class:"function-icon filter-icon"},{default:a(()=>[_("ðŸŽ¨")]),_:1}),d(l,{class:"function-name"},{default:a(()=>[_("æ»¤é•œåº“")]),_:1}),d(l,{class:"function-desc"},{default:a(()=>[_("10+é¢„è®¾é£Žæ ¼")]),_:1})]),_:1}),d(c,{class:"function-item",onClick:K},{default:a(()=>[d(c,{class:"function-icon text-icon"},{default:a(()=>[_("ðŸ“")]),_:1}),d(l,{class:"function-name"},{default:a(()=>[_("æ–‡å­—æ¨¡æ¿")]),_:1}),d(l,{class:"function-desc"},{default:a(()=>[_("é¢„è®¾+è‡ªå®šä¹‰")]),_:1})]),_:1}),d(c,{class:"function-item",onClick:T},{default:a(()=>[d(c,{class:"function-icon music-icon"},{default:a(()=>[_("ðŸŽµ")]),_:1}),d(l,{class:"function-name"},{default:a(()=>[_("èƒŒæ™¯éŸ³ä¹")]),_:1}),d(l,{class:"function-desc"},{default:a(()=>[_("æŽ¨è+æœ¬åœ°å¯¼å…¥")]),_:1})]),_:1}),d(c,{class:"function-item",onClick:q},{default:a(()=>[d(c,{class:"function-icon effects-icon"},{default:a(()=>[_("âœ¨")]),_:1}),d(l,{class:"function-name"},{default:a(()=>[_("ç‰¹æ•ˆæ·»åŠ ")]),_:1}),d(l,{class:"function-desc"},{default:a(()=>[_("æ…¢åŠ¨ä½œ/å›žæ”¾ç­‰")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),M.value?(u(),t(c,{key:0,class:"share-modal",onClick:W},{default:a(()=>[d(c,{class:"share-modal-content",onClick:s[0]||(s[0]=y(()=>{},["stop"]))},{default:a(()=>[d(c,{class:"share-modal-header"},{default:a(()=>[d(l,{class:"modal-title"},{default:a(()=>[_("åˆ†äº«åˆ°")]),_:1}),d(c,{class:"close-btn",onClick:W},{default:a(()=>[d(l,{class:"close-icon"},{default:a(()=>[_("âœ•")]),_:1})]),_:1})]),_:1}),d(c,{class:"share-options"},{default:a(()=>[d(c,{class:"share-option",onClick:X},{default:a(()=>[d(c,{class:"share-option-icon wechat-icon"},{default:a(()=>[_("ðŸ’¬")]),_:1}),d(l,{class:"share-option-text"},{default:a(()=>[_("å¾®ä¿¡")]),_:1})]),_:1}),d(c,{class:"share-option",onClick:Y},{default:a(()=>[d(c,{class:"share-option-icon weibo-icon"},{default:a(()=>[_("ðŸ“±")]),_:1}),d(l,{class:"share-option-text"},{default:a(()=>[_("å¾®åš")]),_:1})]),_:1}),d(c,{class:"share-option",onClick:Z},{default:a(()=>[d(c,{class:"share-option-icon douyin-icon"},{default:a(()=>[_("ðŸŽµ")]),_:1}),d(l,{class:"share-option-text"},{default:a(()=>[_("æŠ–éŸ³")]),_:1})]),_:1}),d(c,{class:"share-option",onClick:ee},{default:a(()=>[d(c,{class:"share-option-icon more-icon"},{default:a(()=>[_("â‹¯")]),_:1}),d(l,{class:"share-option-text"},{default:a(()=>[_("æ›´å¤š")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):f("",!0),d(L)]),_:1})}}},[["__scopeId","data-v-fcb1f192"]]);export{U as default};
