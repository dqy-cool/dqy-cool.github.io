import{z as e,L as a,s}from"./index-DjgUAJ8w.js";const t="https://xdlujxwaraxm.sealosbja.site/api",o=3e4;function r(e){return e.email&&e.password?e.password.length<8?Promise.reject(new Error("密码长度至少为8位")):new Promise((r,n)=>{const{email:i,password:d,nickname:l,avatar:c,phone:u}=e;a({url:`${t}/auth/register`,method:"POST",data:{email:i,password:d,...l&&{nickname:l},...c&&{avatar:c},...u&&{phone:u}},header:{"Content-Type":"application/json"},timeout:o,success:e=>{var a,t,o;if(201===e.statusCode)r(e.data);else if(409===e.statusCode){const t=(null==(a=e.data)?void 0:a.message)||"Email already exists";s({title:t,icon:"none"}),n(new Error(t))}else if(400===e.statusCode){const a=(null==(t=e.data)?void 0:t.message)||"注册参数错误";s({title:a,icon:"none"}),n(new Error(a))}else{const a=(null==(o=e.data)?void 0:o.message)||`注册失败: ${e.statusCode}`;s({title:a,icon:"none"}),n(new Error(a))}},fail:e=>{console.error("注册请求失败:",e);const a=e.errMsg||"网络请求失败";s({title:a,icon:"none"}),n(new Error(a))}})}):Promise.reject(new Error("邮箱和密码不能为空"))}function n(e){return e.email&&e.password?new Promise((r,n)=>{const{email:i,password:d}=e;a({url:`${t}/auth/login`,method:"POST",data:{email:i,password:d},header:{"Content-Type":"application/json"},timeout:o,success:e=>{var a,t,o;if(201===e.statusCode)r(e.data);else if(401===e.statusCode){const t=(null==(a=e.data)?void 0:a.message)||"Invalid credentials";s({title:t,icon:"none"}),n(new Error(t))}else if(400===e.statusCode){const a=(null==(t=e.data)?void 0:t.message)||"登录参数错误";s({title:a,icon:"none"}),n(new Error(a))}else{const a=(null==(o=e.data)?void 0:o.message)||`登录失败: ${e.statusCode}`;s({title:a,icon:"none"}),n(new Error(a))}},fail:e=>{console.error("登录请求失败:",e);const a=e.errMsg||"网络请求失败";s({title:a,icon:"none"}),n(new Error(a))}})}):Promise.reject(new Error("邮箱和密码不能为空"))}function i(s){return new Promise((r,n)=>{const i=e("token"),d={"Content-Type":"application/json"};i&&(d.Authorization=`Bearer ${i}`),a({url:`${t}/video-segments/camera/${s}`,method:"GET",header:d,timeout:o,success:e=>{var a;200===e.statusCode?void 0!==e.data.success?r(e.data.success&&e.data.data||[]):0===e.data.code?r(e.data.data||[]):r(e.data||[]):n(new Error((null==(a=e.data)?void 0:a.message)||"获取视频段列表失败"))},fail:e=>{console.error("获取视频段列表失败:",e),n(new Error(e.errMsg||"网络请求失败"))}})})}function d(s){return new Promise((r,n)=>{const i=e("token"),d={"Content-Type":"application/json"};i&&(d.Authorization=`Bearer ${i}`),a({url:`${t}/recordings/${s}/segments`,method:"GET",header:d,timeout:o,success:e=>{var a;200===e.statusCode?void 0!==e.data.success?r(e.data.success&&e.data.data||[]):0===e.data.code?r(e.data.data||[]):r(e.data||[]):n(new Error((null==(a=e.data)?void 0:a.message)||"获取视频段列表失败"))},fail:e=>{console.error("获取视频段列表失败:",e),n(new Error(e.errMsg||"网络请求失败"))}})})}function l(e){return`${t}/video-segments/${e}/download`}export{d as a,l as b,i as g,n as l,r};
