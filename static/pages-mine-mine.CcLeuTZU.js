import{r as a,k as e,a as t,w as l,z as s,i as n,o as c,b as o,f as u,S as i,v as r,d as f,e as d,t as _,B as m,I as v,x as k,s as p,j as h,M as b,g,h as y,A as w}from"./index-DjgUAJ8w.js";import{C}from"./index.dnR_Pn36.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=x({__name:"mine",setup(x){const A=a({avatar:"",nickname:"",level:5}),F=a({highlightsCount:12,likesCount:1288}),R=a(!1),j=a({avatar:"",nickname:""}),L=a=>new Promise((e,t)=>{if(a.startsWith("blob:"))fetch(a).then(a=>a.blob()).then(a=>{const l=new FileReader;l.onload=()=>e(l.result),l.onerror=t,l.readAsDataURL(a)}).catch(t);else{const l=new XMLHttpRequest;l.open("GET",a,!0),l.responseType="blob",l.onload=function(){if(200===this.status||0===this.status){const a=new FileReader;a.onload=function(){e(a.result)},a.onerror=t,a.readAsDataURL(l.response)}else t(new Error("Âä†ËΩΩÂõæÁâáÂ§±Ë¥•"))},l.onerror=t,l.send()}}),T=()=>{V()},U=()=>{b({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:async a=>{const e=a.tempFilePaths[0];try{g({title:"Â§ÑÁêÜ‰∏≠...",mask:!0});const a=await L(e);j.value.avatar=a,y()}catch(t){console.error("Â§ÑÁêÜÂ§¥ÂÉèÂ§±Ë¥•:",t),y(),p({title:"Â§ÑÁêÜÂ§¥ÂÉèÂ§±Ë¥•",icon:"none"})}},fail:a=>{console.error("ÈÄâÊã©Â§¥ÂÉèÂ§±Ë¥•:",a),p({title:"ÈÄâÊã©Â§¥ÂÉèÂ§±Ë¥•",icon:"none"})}})},V=()=>{j.value={avatar:A.value.avatar||"",nickname:A.value.nickname||""},R.value=!0},z=()=>{R.value=!1},D=async()=>{if(j.value.nickname&&0===j.value.nickname.trim().length)p({title:"ÊòµÁß∞‰∏çËÉΩ‰∏∫Á©∫",icon:"none"});else try{if(j.value.avatar)if(j.value.avatar.startsWith("data:image"))A.value.avatar=j.value.avatar,w("userAvatar",j.value.avatar);else try{g({title:"‰øùÂ≠ò‰∏≠...",mask:!0});const a=await L(j.value.avatar);A.value.avatar=a,w("userAvatar",a),y()}catch(a){return console.error("ËΩ¨Êç¢Â§¥ÂÉèÂ§±Ë¥•:",a),y(),void p({title:"‰øùÂ≠òÂ§¥ÂÉèÂ§±Ë¥•",icon:"none"})}j.value.nickname&&(A.value.nickname=j.value.nickname.trim(),w("userNickname",j.value.nickname.trim())),p({title:"‰øùÂ≠òÊàêÂäü",icon:"success"}),z()}catch(a){console.error("‰øùÂ≠òËµÑÊñôÂ§±Ë¥•:",a),p({title:"‰øùÂ≠òÂ§±Ë¥•",icon:"none"})}},E=()=>{k({url:"/pages/highlights/highlights?mode=my"})},I=()=>{p({title:"ÊâìÂºÄËçâÁ®øÁÆ±",icon:"none"})},M=()=>{p({title:"ÊàëÁöÑÊî∂Ëóè",icon:"none"})},N=()=>{h({url:"/pages/billiards/billiards"})},P=()=>{p({title:"È¢ÑÁ∫¶ËÆ∞ÂΩïÔºàÂäüËÉΩÈ¢ÑÁïôÔºâ",icon:"none"})},S=()=>{p({title:"ËÆæÁΩÆ‰∏éÂÆ¢Êúç",icon:"none"})};return e(()=>{(()=>{try{const a=s("userAvatar"),e=s("userNickname");a&&(A.value.avatar=a),e&&(A.value.nickname=e)}catch(a){console.error("Âä†ËΩΩÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:",a)}})()}),(a,e)=>{const s=r,k=f,p=n,h=i,b=v;return c(),t(p,{class:"mine-container"},{default:l(()=>[o(h,{class:"content-scroll","scroll-y":""},{default:l(()=>[o(p,{class:"user-info-section"},{default:l(()=>[o(p,{class:"user-avatar-wrapper",onClick:T},{default:l(()=>[A.value.avatar?(c(),t(s,{key:0,src:A.value.avatar,class:"user-avatar",mode:"aspectFill"},null,8,["src"])):(c(),t(p,{key:1,class:"user-avatar-placeholder"},{default:l(()=>[o(k,{class:"avatar-text"},{default:l(()=>[d(_(A.value.nickname?A.value.nickname.charAt(0):"Áî®"),1)]),_:1})]),_:1})),o(p,{class:"level-badge"},{default:l(()=>[o(k,{class:"level-text"},{default:l(()=>[d("Lv."+_(A.value.level||1),1)]),_:1})]),_:1})]),_:1}),o(p,{class:"user-info-content"},{default:l(()=>[o(p,{class:"nickname-wrapper"},{default:l(()=>[A.value.nickname?(c(),t(k,{key:0,class:"nickname"},{default:l(()=>[d(_(A.value.nickname),1)]),_:1})):(c(),t(k,{key:1,class:"nickname-placeholder"},{default:l(()=>[d("ÁÇπÂáªËÆæÁΩÆÊòµÁß∞")]),_:1}))]),_:1}),o(p,{class:"stats-row"},{default:l(()=>[o(p,{class:"stat-item",onClick:E},{default:l(()=>[o(k,{class:"stat-number"},{default:l(()=>[d(_(F.value.highlightsCount),1)]),_:1}),o(k,{class:"stat-label"},{default:l(()=>[d("ÈõÜÈî¶")]),_:1})]),_:1}),o(p,{class:"stat-divider"}),o(p,{class:"stat-item"},{default:l(()=>[o(k,{class:"stat-number"},{default:l(()=>{return[d(_((a=F.value.likesCount,a>=1e4?(a/1e4).toFixed(1)+"w":a>=1e3?(a/1e3).toFixed(1)+"k":a.toString())),1)];var a}),_:1}),o(k,{class:"stat-label"},{default:l(()=>[d("Ëé∑Ëµû")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(p,{class:"function-section"},{default:l(()=>[o(p,{class:"function-item",onClick:E},{default:l(()=>[o(p,{class:"function-icon highlights-icon"},{default:l(()=>[d("üé¨")]),_:1}),o(p,{class:"function-content"},{default:l(()=>[o(k,{class:"function-title"},{default:l(()=>[d("ÊàëÁöÑÈõÜÈî¶")]),_:1}),o(k,{class:"function-desc"},{default:l(()=>[d("ÊåâÊó∂Èó¥ÊéíÂàó")]),_:1})]),_:1}),o(k,{class:"function-arrow"},{default:l(()=>[d("‚Ä∫")]),_:1})]),_:1}),o(p,{class:"function-item",onClick:I},{default:l(()=>[o(p,{class:"function-icon drafts-icon"},{default:l(()=>[d("üìù")]),_:1}),o(p,{class:"function-content"},{default:l(()=>[o(k,{class:"function-title"},{default:l(()=>[d("ÊàëÁöÑËçâÁ®ø")]),_:1}),o(k,{class:"function-desc"},{default:l(()=>[d("ÁªßÁª≠ÁºñËæë")]),_:1})]),_:1}),o(k,{class:"function-arrow"},{default:l(()=>[d("‚Ä∫")]),_:1})]),_:1}),o(p,{class:"function-item",onClick:M},{default:l(()=>[o(p,{class:"function-icon favorites-icon"},{default:l(()=>[d("‚≠ê")]),_:1}),o(p,{class:"function-content"},{default:l(()=>[o(k,{class:"function-title"},{default:l(()=>[d("ÊàëÁöÑÊî∂Ëóè")]),_:1}),o(k,{class:"function-desc"},{default:l(()=>[d("ÁêÉÊàø/ÈõÜÈî¶")]),_:1})]),_:1}),o(k,{class:"function-arrow"},{default:l(()=>[d("‚Ä∫")]),_:1})]),_:1}),o(p,{class:"function-item",onClick:N},{default:l(()=>[o(p,{class:"function-icon nearby-icon"},{default:l(()=>[d("üìç")]),_:1}),o(p,{class:"function-content"},{default:l(()=>[o(k,{class:"function-title"},{default:l(()=>[d("ÈôÑËøëÁêÉÊàø")]),_:1}),o(k,{class:"function-desc"},{default:l(()=>[d("Âü∫‰∫éÂÆö‰ΩçÊé®Ëçê")]),_:1})]),_:1}),o(k,{class:"function-arrow"},{default:l(()=>[d("‚Ä∫")]),_:1})]),_:1}),o(p,{class:"function-item",onClick:P},{default:l(()=>[o(p,{class:"function-icon booking-icon"},{default:l(()=>[d("üìÖ")]),_:1}),o(p,{class:"function-content"},{default:l(()=>[o(k,{class:"function-title"},{default:l(()=>[d("È¢ÑÁ∫¶ËÆ∞ÂΩï")]),_:1}),o(k,{class:"function-desc"},{default:l(()=>[d("È¢ÑÁïô")]),_:1})]),_:1}),o(k,{class:"function-arrow"},{default:l(()=>[d("‚Ä∫")]),_:1})]),_:1}),o(p,{class:"function-item",onClick:S},{default:l(()=>[o(p,{class:"function-icon settings-icon"},{default:l(()=>[d("‚öôÔ∏è")]),_:1}),o(p,{class:"function-content"},{default:l(()=>[o(k,{class:"function-title"},{default:l(()=>[d("ËÆæÁΩÆ‰∏éÂÆ¢Êúç")]),_:1}),o(k,{class:"function-desc"},{default:l(()=>[d("Ë¥¶Êà∑ËÆæÁΩÆ„ÄÅÂ∏ÆÂä©‰∏≠ÂøÉ")]),_:1})]),_:1}),o(k,{class:"function-arrow"},{default:l(()=>[d("‚Ä∫")]),_:1})]),_:1})]),_:1})]),_:1}),R.value?(c(),t(p,{key:0,class:"modal-overlay",onClick:z},{default:l(()=>[o(p,{class:"modal-content",onClick:e[1]||(e[1]=m(()=>{},["stop"]))},{default:l(()=>[o(p,{class:"modal-header"},{default:l(()=>[o(k,{class:"modal-title"},{default:l(()=>[d("ÁºñËæëËµÑÊñô")]),_:1}),o(k,{class:"modal-close",onClick:z},{default:l(()=>[d("√ó")]),_:1})]),_:1}),o(p,{class:"modal-body"},{default:l(()=>[o(p,{class:"form-item"},{default:l(()=>[o(k,{class:"form-label"},{default:l(()=>[d("ÊòµÁß∞")]),_:1}),o(b,{class:"form-input",modelValue:j.value.nickname,"onUpdate:modelValue":e[0]||(e[0]=a=>j.value.nickname=a),placeholder:"ËØ∑ËæìÂÖ•ÊòµÁß∞","placeholder-class":"input-placeholder",maxlength:"20"},null,8,["modelValue"])]),_:1}),o(p,{class:"form-item"},{default:l(()=>[o(k,{class:"form-label"},{default:l(()=>[d("Â§¥ÂÉè")]),_:1}),o(p,{class:"avatar-upload-wrapper"},{default:l(()=>[o(p,{class:"avatar-upload-btn",onClick:U},{default:l(()=>[j.value.avatar?(c(),t(s,{key:0,src:j.value.avatar,class:"preview-avatar",mode:"aspectFill"},null,8,["src"])):(c(),t(k,{key:1,class:"upload-text"},{default:l(()=>[d("ÈÄâÊã©Â§¥ÂÉè")]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),o(p,{class:"modal-footer"},{default:l(()=>[o(p,{class:"modal-btn cancel-btn",onClick:z},{default:l(()=>[o(k,{class:"modal-btn-text"},{default:l(()=>[d("ÂèñÊ∂à")]),_:1})]),_:1}),o(p,{class:"modal-btn confirm-btn",onClick:D},{default:l(()=>[o(k,{class:"modal-btn-text"},{default:l(()=>[d("‰øùÂ≠ò")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):u("",!0),o(C)]),_:1})}}},[["__scopeId","data-v-d446662c"]]);export{A as default};
